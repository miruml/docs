---
title: "Expand"
---

## Single Expansion

Many response objects contain references to objects which are not included in the default response. 

For instance, a [config instance](/docs/api-reference/config-instances/get) has the following default response structure.

```json
{
  "object": "config_instance",
  "id": "cfg_inst_123",
  "target_status": "created",
  "activity_status": "created",
  "error_status": "none",
  "status": "created",
  "relative_filepath": "/v1/motion-control.json",
  "created_at": "2021-01-01T00:00:00Z",
  "updated_at": "2021-01-01T00:00:00Z",
  "device_id": "dvc_123",
  "config_schema_id": "cfg_sch_123",
  "config_type_id": "cfg_type_123",
  "device": null,
  "config_schema": null,
  "config_type": null,
  "content": null,
}
```

To retrieve the device for a config instance, you could make two separate requests. 

First, fetch the config instance using the config instance ID (assuming you already know the ID). Then, having obtained the `device_id` from the config instance response, fetch the device using the device ID.

This is workable but adds both latency and complexity to your code. Instead, you can expand the `device` field in the original config instance request to make a single request to the Miru API.

By default, the `device`, `config_schema`, `config_type`, and `content` fields are not included in the config instance response. You can expand any of these fields using the `expand[]` query parameter. Below, our request expands the `device` field using `expand[]=device`.

<Tabs>
  <Tab title="Request">
    ```bash
    curl --request GET \
    --url https://configs.api.miruml.com/v1/config_instances/cfg_inst_123?expand[]=device \
    --header 'X-API-Key: <api-key>'
    ```
  </Tab>

  <Tab title="Response">
    ```json
    {
      "object": "config_instance",
      "id": "cfg_inst_123",
      "target_status": "created",
      "activity_status": "created",
      "error_status": "none",
      "status": "created",
      "relative_filepath": "/v1/motion-control.json",
      "created_at": "2021-01-01T00:00:00Z",
      "updated_at": "2021-01-01T00:00:00Z",
      "device_id": "dvc_123",
      "config_schema_id": "cfg_sch_123",
      "config_type_id": "cfg_type_123",
      "device": {
        "object": "device",
        "id": "dvc_123",
        "name": "My Device",
        "status": "active",
        "created_at": "2021-01-01T00:00:00Z",
        "updated_at": "2021-01-01T00:00:00Z",
      },
      "config_schema": null,
      "config_type": null,
      "content": null,
    }
    ```
  </Tab>
</Tabs>

The response then includes the `device` that the config instance belongs to, reducing our request count from two to one.

Expansions are a powerful tool for reducing latency, code complexity, and the number of requests you make to the Miru API.

To see a full list of expandable fields for an object, look for the `expand[]` parameter in the **Query Parameters** section of the API endpoint you are querying.


## Multiple Expansions

To expand more than one property for a response object, pass in multiple `expand[]` parameters separated by the `&` character. The following request expands both the `device` and `content` fields of the config instance using `expand[]=device&expand[]=content`.

<Tabs>
  <Tab title="Request">
    ```bash
    curl --request GET \
      --url https://configs.api.miruml.com/v1/config_instances/cfg_inst_123?expand[]=device&expand[]=content \
      --header 'X-API-Key: <api-key>'
    ```
  </Tab>

  <Tab title="Response">
    ```json
    {
      "object": "config_instance",
      "id": "cfg_inst_123",
      "target_status": "created",
      "activity_status": "created",
      "error_status": "none",
      "status": "created",
      "relative_filepath": "/v1/motion-control.json",
      "created_at": "2021-01-01T00:00:00Z",
      "updated_at": "2021-01-01T00:00:00Z",
      "device_id": "dvc_123",
      "config_schema_id": "cfg_sch_123",
      "config_type_id": "cfg_type_123",
      "device": {
        "object": "device",
        "id": "dvc_123",
        "name": "My Device",
        "status": "active",
        "created_at": "2021-01-01T00:00:00Z",
        "updated_at": "2021-01-01T00:00:00Z",
      },
      "config_schema": null,
      "config_type": null,
      "content": {
        "enable_autonomy": true,
        "enable_remote_control": false,
        "max_payload_kg": 8.5,
        "preferred_speed_mode": "normal",
        "emergency_stop_sensitivity": 0.9,
        "telemetry": {
            "upload_interval_sec": 45,
            "heartbeat_interval_sec": 15
        }
      }
    }
    ```
  </Tab>
</Tabs>

Feel free to expand as many fields as you need. However, keep in mind that expansions add some latency to API requests, so only expand fields that are truly needed.


## Nested Expansions

When expanding a reference to an object, it's often the case that the expanded objects contain references to other objects. For instance, config instances contain a reference to a config schema and config schemas contain a reference to a config type.

To expand nested objects, simply use the dot (`.`) notation with the `expand[]` parameter. For instance, the following request expands the `config_type` inside of the `config_schema` of the config instance using `expand[]=config_schema.config_type`.

<Tabs>
  <Tab title="Request">
    ```bash
    curl --request GET \
      --url https://configs.api.miruml.com/v1/config_instances/cfg_inst_123?expand[]=config_schema.config_type \
      --header 'X-API-Key: <api-key>'
    ```
  </Tab>

  <Tab title="Response">
    ```json
    {
      "object": "config_instance",
      "id": "cfg_inst_123",
      "target_status": "created",
      "activity_status": "created",
      "error_status": "none",
      "status": "created",
      "relative_filepath": "/v1/motion-control.json",
      "created_at": "2021-01-01T00:00:00Z",
      "updated_at": "2021-01-01T00:00:00Z",
      "device_id": "dvc_123",
      "config_schema_id": "cfg_sch_123",
      "config_type_id": "cfg_type_123",
      "device": null,
      "config_schema": {
        "object": "config_schema",
        "id": "cfg_sch_123",
        "version": 2,
        "digest": "1a2b3c4d5e",
        "relative_filepath": "/v1/motion-control.json",
        "created_at": "2021-01-01T00:00:00Z",
        "updated_at": "2021-01-01T00:00:00Z",
        "config_type_id": "cfg_typ_123",
        "config_type": {
          "object": "config_type",
          "id": "cfg_type_123",
          "name": "Motion Control",
          "slug": "motion-control",
          "created_at": "2021-01-01T00:00:00Z",
          "updated_at": "2021-01-01T00:00:00Z",
          "config_schemas": null,
        },
        "content": null,
      },
      "config_type": null,
      "content": null,
    }
    ```
  </Tab>
</Tabs>

<Warning>
Expansions cannot be nested beyond four levels deep. `expand[]=field1.field2.field3.field4` is the maximum depth.
</Warning>

When expanding nested fields, there's no need to expand the parent field. Since our request expands the `config_type` field inside the `config_schema` field, the `config_schema` field is automatically expanded as well. No need to expand `config_schema` separately in the request.

Feel free to expand as deep as you need (up to four levels of course!). However, keep in mind that expansions add some latency to API requests, so only expand fields that are truly needed.


## List Expansions

### Items

Expanding a list of config instances is identical to expanding a single config instance. By default, [listing config instances](/docs/api-reference/config-instances/list) returns the following response structure.

```json
{
  "object": "list",
  "total_count": -1,
  "limit": 10,
  "offset": 0,
  "has_more": true,
  "data": [
    {
      "object": "config_instance",
      "id": "cfg_inst_123",
      ...
      "content": null,
    },
    {
      "object": "config_instance",
      "id": "cfg_inst_456",
      ...
      "content": null,
    },
    ...
  ],
}
```

To expand the `content` field for every config instance in the list, use the `expand[]` parameter as if you were expanding a single config instance. 

This may be unlike other API endpoints you may have seen, where `data` is prepended to expansion parameters (`expand[]=data.content`) for lists. The Miru API implicitly applies the expansion to each item in the list, not the list itself.

The following request expands the `content` field for every config instance in the list using `expand[]=content`.

<Tabs>
  <Tab title="Request">
    ```bash
    curl --request GET \
      --url 'https://configs.api.miruml.com/v1/config_instances?expand[]=content' \
      --header 'X-API-Key: <api-key>'
    ```
  </Tab>

  <Tab title="Response">
    ```json
    {
      "object": "list",
      "total_count": -1,
      "limit": 10,
      "offset": 0,
      "has_more": true,
      "data": [
        {
          "object": "config_instance",
          "id": "cfg_inst_123",
          ...
          "content": {
            "enable_autonomy": true,
            "enable_remote_control": false,
            "max_payload_kg": 8.5,
            "preferred_speed_mode": "normal",
            "emergency_stop_sensitivity": 0.9,
            "telemetry": {
              "upload_interval_sec": 45,
              "heartbeat_interval_sec": 15
            }
          }
        },
        {
          "object": "config_instance",
          "id": "cfg_inst_456",
          ...
          "content": {
            "enable_autonomy": false,
            "enable_remote_control": false,
            "max_payload_kg": 11.5,
            "preferred_speed_mode": "fast",
            "emergency_stop_sensitivity": 0.9,
            "telemetry": {
              "upload_interval_sec": 30,
              "heartbeat_interval_sec": 60
            }
          }
        },
        ...
      ],
    }
    ```
  </Tab>
</Tabs>

### Total Count

The `total_count` field of a list response is the total number of items matching the query. Since requests are [paginated](/docs/api-reference/queries/pagination), the number of items returned in a list may be less than the actual number of items matching the query.

If a list query matches 100 items but the `limit` parameter is set to 10, the list response would contain only 10 items despite the total count being 100.

Those of you with a keen eye may have noticed that the `total_count` field is `-1` in the responses above. By default, the Miru API does not return the total count of list queries. 

`total_count` must be explicitly requested by expanding the `total_count` field. The following request expands the `total_count` field using `expand[]=total_count`.

<Tabs>
  <Tab title="Request">
    ```bash
    curl --request GET \
      --url 'https://configs.api.miruml.com/v1/config_instances?expand[]=total_count' \
      --header 'X-API-Key: <api-key>'
    ```
  </Tab>

  <Tab title="Response">
    ```json
    {
      "object": "list",
      "total_count": 15,
      "limit": 10,
      "offset": 0,
      "has_more": true,
      "data": [
        {
          "object": "config_instance",
          "id": "cfg_inst_123",
          ...
          "content": {
            "enable_autonomy": true,
            "enable_remote_control": false,
            "max_payload_kg": 8.5,
            "preferred_speed_mode": "normal",
            "emergency_stop_sensitivity": 0.9,
            "telemetry": {
              "upload_interval_sec": 45,
              "heartbeat_interval_sec": 15
            }
          }
        },
        {
          "object": "config_instance",
          "id": "cfg_inst_456",
          ...
          "content": {
            "enable_autonomy": false,
            "enable_remote_control": false,
            "max_payload_kg": 11.5,
            "preferred_speed_mode": "fast",
            "emergency_stop_sensitivity": 0.9,
            "telemetry": {
              "upload_interval_sec": 30,
              "heartbeat_interval_sec": 60
            }
          }
        },
        ...
      ],
    }
    ```
  </Tab>
</Tabs>

While extremely useful in a select few cases, counting the total number of items is typically unnecessary and can incur heavy latency. Please expand the `total_count` field judiciously, only when you truly need it.
