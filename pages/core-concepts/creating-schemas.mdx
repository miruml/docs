---
title: 'Creating Schemas'
---

## Configs

Below are some [Configs](/pages/vocabulary#config) for a fictional robot. Each **Config** is responsible for a particular aspect of the robot's behavior.

<img src="/images/core-concepts/config-list.png" style={{borderRadius: '7px'}}/>

Every **Config** has a history of [Config Schemas](/pages/vocabulary#config-schema) and [Concrete Configs](/pages/vocabulary#concrete-config) deployed to robots. Below are the config schemas for the `motion-control-config`.

<img src="/images/core-concepts/motion-control-schema-list.png" style={{borderRadius: '7px'}}/>

## Config Schemas
Miru requires the use of **Config Schemas**. These schemas validate **Concrete Configs** before deployment, preventing runtime application errors. 

**Config Schemas** live in a **Git repository**, ideally the same one as the code that consumes them, to minimize versioning errors between code and configurations.

As an example, let's say our application has the following directory structure.

```
src/...
configs/
â”œâ”€â”€ motion-control-config.yaml
â””â”€â”€ ...
config-schemas/
â”œâ”€â”€ motion-control-schema.yaml
â””â”€â”€ ...
```

<Accordion title="motion-control-config.yaml">
```yaml
speed: 10
features:
  spin: true
  jump: true
  backflip: false
accelerometer:
  id: acc_id_1
  offsets:
    x: 0.1
    y: 0.13
    z: -0.04
  scaling_factor:
    x: 1.0
    y: 1.02
    z: 0.99
```
</Accordion>

<Accordion title="motion-control-schema.yaml">
```yaml
$schema: "https://json-schema.org/draft/2020-12/schema"
type: object
properties:
  speed:
    type: integer
    minimum: 1
    default: 10
  features:
    type: object
    properties:
      spin:
        type: boolean
        default: true
      jump:
        type: boolean
        default: false
      backflip:
        type: boolean
        default: false
    required: [spin, jump, backflip]
  accelerometer:
    type: object
    properties:
      id:
        type: string
      offsets:
        type: object
        properties:
          x:
            type: number
          y:
            type: number
          z:
            type: number
        required: [x, y, z]
      scaling_factor:
        type: object
        properties:
          x:
            type: number
          y:
            type: number
          z:
            type: number
        required: [x, y, z]
    required: [id, offsets, scaling_factor]
required: [device_id, speed, features, accelerometer]
```
</Accordion>

The `motion-control-config.yaml` file contains **Concrete Config** values for **development use**, allowing developers to quickly define and edit configurations in their local environment. This file is strictly for local development and will not be uploaded to the cloud or used in production deployments.

The `motion-control-schema.yaml` file defines the schema for `motion-control-config.yaml`, specifying constraints on the parameters that will be instantiated in the **Concrete Config**.

## Local Development 
Miru provides an [SDK](/pages/guides/sdk) for deploying configs, which pulls **Concrete Configs** from the cloud. Here's a sample code snippet of the SDK in action.

<CodeGroup>
```python Python
motion_control_config = client.get_config(
    slug="motion-control-config",
    schema_file="./config-schemas/motion-control-schema.yaml",
)
```

```rust Rust
let motion_control_config = client.get_config(
    "motion-control-config",
    "./config-schemas/motion-control-schema.yaml"
);
```

```cpp C++
auto motion_control_config = client->getConfig(
    "motion-control-config",
    "./config-schemas/motion-control-schema.yaml"
);
```
</CodeGroup>

It's also critical that the SDK allows for quick changes to **Concrete Config** values in development. The SDK accepts a boolean argument to determine whether it should fetch a **Concrete Config** from a file on the local file system (development) or from the cloud (production).

<CodeGroup>
```python Python
motion_control_config = client.get_config(
    # ... other parameters that don't matter for development
    development_file="./configs/motion-control-config.yaml",
    development=true,
)
```

```rust Rust
let motion_control_config = client.get_config(
    // ... other parameters that don't matter for development
    "./configs/motion-control-config.yaml",
    true,
);
```

```cpp C++
auto motion_control_config = client->getConfig(
    // ... other parameters that don't matter for development
    "./configs/motion-control-config.yaml",
    true,
);
```
</CodeGroup>

In development, the SDK will use the `motion-control-config.yaml` file defined locally. In production, the SDK will pull the **Concrete Config** from the cloud.

## Uploading a Config Schema

Once ready to deploy new configurations, **Config Schemas** are uploaded to the cloud using the Miru [CLI](/pages/guides/cli).

```bash
miru upload \
--config-slug="motion-control-config" \
--config-schema-path="./configs/motion-control-schema.yaml"
```

The `miru upload` command collects Git information to version and track **Config Schemas** in the Miru dashboard. Miru **does not have access to the Git repository**. The Git information is extracted from the repository where the `miru upload` command is run from.

```bash
$ miru upload --config-slug="motion-control-config" --config-schema-path="./configs/motion-control-schema.yaml"

ðŸš€ Attempting to upload schema ./configs/motion-control-schema.yaml for config motion-control-config...

Git Information:
commit: 8f4d2e1
origin: git@github.com:miru/config-service.git
branch: origin/main

âœ… Successfully uploaded schema for config motion-control-config
Schema is now available for use in production deployments.
```

After executing `miru upload`, **Config Schemas** are available in the Miru dashboard.

<img src="/images/core-concepts/motion-control-schema-list.png" style={{borderRadius: '7px'}}/>

It is reccomended to use the `miru upload` command in the CI pipeline to upload **Config Schemas** automatically. Miru will know if a **Config Schema** has changed and will not create a new **Config Schema** if it has already been uploaded in a previous commit.